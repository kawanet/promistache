!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Promistache=n()}}((function(){return function n(r,t,e){function u(o,f){if(!t[o]){if(!r[o]){var c="function"==typeof require&&require;if(!f&&c)return c(o,!0);if(i)return i(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var s=t[o]={exports:{}};r[o][0].call(s.exports,(function(n){return u(r[o][1][n]||n)}),s,s.exports,n,r,t,e)}return t[o].exports}for(var i="function"==typeof require&&require,o=0;o<e.length;o++)u(e[o]);return u}({1:[function(n,r,t){"use strict";var e=t.parse=n("./lib/parse").parse,u=n("./lib/runtime-async").runtime,i=n("./lib/runtime-sync").runtime;function o(n,r){if("function"!=typeof n){var t=e(n,r);n=Function("G","I","S","U","V","return "+t)}return n}t.compileAsync=function(n,r){return u(o(n,r))},t.compile=function(n,r){return i(o(n,r))}},{"./lib/parse":2,"./lib/runtime-async":3,"./lib/runtime-sync":4}],2:[function(n,r,t){"use strict";t.parse=function n(r,t){var e,o=[],f="",c={"&":b,"/":function(n){if(!o.length)throw new Error("Closing tag without opener: "+n);if(e!==n)throw new Error("Nesting error: "+e+" vs. "+n);o.pop(),e=o[o.length-1],m("","])",",")},"!":function(){},"^":function(n){e=n,o.push(e),m(f,'I("'+e+'",[')},">":function(n){m(f,'U(">'+i(n)+'")',",")},"#":function(n){e=n,o.push(e),m(f,'S("'+e+'",[')},"{":function(n){return b(n.substr(0,n.length-1))}},a="{{([^{}]*|{[^{}]*})}}",s=["G(["];r+="";var l=t&&t.tag;l||r.replace(/{{=(.*?)=}}/,(function(e,u,o){var f=r.substr(0,o);r=r.substr(o+e.length),f.search(/(^|\n)[ \t]*$/)>-1&&r.search(/^[ \t]*(\r?\n|$)/)>-1&&(f=f.replace(/[ \t]*$/,""),r=r.replace(/^[ \t]*\r?\n?/,"")),f&&s.push(n(f,t),","),l=i(u)}));l&&(l=l.replace(/[!-.?\[-\]{-}]/g,u),a=l.replace(/\s+/,"(.*?)"));for(var p={"/":1,"!":1,"^":1,">":1,"#":1},h=r.split(new RegExp(a)),v=h.length,g=v-2;g>0;g-=2){var y=h[g-1],d=h[g+1];p[h[g][0]]&&(1===g?y.search(/(^|\n)[ \t]*$/)>-1:y.search(/\n[ \t]*$/)>-1)&&(g===v-2?d.search(/^[ \t]*(\r?\n|$)/)>-1:d.search(/^[ \t]*\r?\n/)>-1)&&(h[g-1]=y.replace(/[ \t]*$/,""),h[g+1]=d.replace(/^[ \t]*\r?\n?/,""))}if(h.forEach((function(n,r){1&r?function(n){var r=c[n[0]];r?r(i(n.substr(1))):function(n){m(f,'V("'+n+'")',",")}(i(n))}(n):function(n){m(f,function(n){return n&&"'"+n.replace(/([\x00-\x1F'\\])/g,u)+"'"}(n),",")}(n)})),o.length)throw new Error("missing closing tag: "+e);return m("])"),s.join("");function m(n,r,t){s.push(n,r),f=t}function b(n){m(f,'U("'+i(n)+'")',",")}};var e={"\t":"\\t","\n":"\\n","\r":"\\r","'":"\\'","\\":"\\\\"};function u(n){var r=n.charCodeAt(0);return e[n]||(r<16?"\\x0":"\\x")+r.toString(16).toUpperCase()}function i(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")}},{}],3:[function(n,r,t){"use strict";t.runtime=function(){var n=Array.isArray,r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(t,u,e,o,i)};function t(n){return function r(t,e,u){return u?c(n,t,e,u):f(r,t,e)}}function e(r,t){var e=o(r);return function r(u,i,o){return o?e(u,i).then((function(r){if(n(r))return a(r,e);if(r)return e("object"==typeof r?r:u);function e(n){return c(t,n,i,o)}})):f(r,u,i)}}function u(r,t){var e=o(r);return function r(u,i,o){return o?e(u,i).then((function(r){if(!r||n(r)&&!r.length)return c(t,u,i,o)})):f(r,u,i)}}function i(n){var r=o(n);return function(n,t){return r(n,t).then(l)}}function o(n){if("."===n)return s;var r=n[0],t="."===r,e=">"===r;t||e?n=n.substr(1):t=e=!0;var u=n.split("."),i=u.length;return function(n,r){var o,f,c;if(t)for(c=n,o=0;c&&o<i;)f=c,c=c[u[o++]];if(e&&null==c)for(c=r,o=0;c&&o<i;)f=c,c=c[u[o++]];return"function"==typeof c?s().then((function(){return c.call(f,n,r)})):s(c)}}function f(n,r,t){var e;return s().then((function(){return n(r,t,u)})).then((function(){return e?e.join(""):""}));function u(n){null!=n&&(e||(e=[]),e.push(n))}}function c(n,r,t,e){return a(n,(function(n){if("function"==typeof n)return s().then((function(){return n(r,t)})).then((function(n){return a(n,e)}));return e(n)}))}function a(r,t){var e=s();return n(r)?r.forEach(u):u(r),e;function u(n){e=e.then((function(){return t(n)}))}}function s(n){return Promise.resolve(n)}function l(n){if(null!=n)return"string"!=typeof n&&(n+=""),n.search(/["&>]/)<0?n:n.replace(/[<"&>]/g,(function(n){return r[n]}))}}()},{}],4:[function(n,r,t){"use strict";t.runtime=function(){var n=Array.isArray,r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(t,u,e,o,i)};function t(n){return function r(t,e,u){if(!u)return f(r,t,e);c(n,t,e,u)}}function e(r,t){var e=o(r);return function r(u,i,o){if(!o)return f(r,u,i);var a=e(u,i);n(a)?a.forEach(s):a&&s("object"==typeof a?a:u);function s(n){c(t,n,i,o)}}}function u(r,t){var e=o(r);return function r(u,i,o){if(!o)return f(r,u,i);var a=e(u,i);(!a||n(a)&&!a.length)&&c(t,u,i,o)}}function i(n){var t=o(n);return function(n,e){return function(n){if(null==n)return;"string"!=typeof n&&(n+="");return n.search(/["&>]/)<0?n:n.replace(/[<"&>]/g,(function(n){return r[n]}))}(t(n,e))}}function o(n){if("."===n)return s;var r=n[0],t="."===r,e=">"===r;t||e?n=n.substr(1):t=e=!0;var u=n.split("."),i=u.length;return function(n,r){var o,f,c;if(t)for(c=n,o=0;c&&o<i;)f=c,c=c[u[o++]];if(e&&null==c)for(c=r,o=0;c&&o<i;)f=c,c=c[u[o++]];return"function"==typeof c?c.call(f,n,r):null!=c?c:void 0}}function f(n,r,t){var e;return n(r,t,(function(n){null!=n&&(e||(e=[]),e.push(n))})),e?e.join(""):""}function c(n,r,t,e){a(n,(function n(u){"function"==typeof u?a(u=u(r,t),n):e(u)}))}function a(r,t){n(r)?r.forEach(t):t(r)}function s(n){return n}}()},{}]},{},[1])(1)}));
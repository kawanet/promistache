!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Promistache=n()}}(function(){return function i(o,f,c){function a(r,n){if(!f[r]){if(!o[r]){var t="function"==typeof require&&require;if(!n&&t)return t(r,!0);if(s)return s(r,!0);var e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}var u=f[r]={exports:{}};o[r][0].call(u.exports,function(n){return a(o[r][1][n]||n)},u,u.exports,i,o,f,c)}return f[r].exports}for(var s="function"==typeof require&&require,n=0;n<c.length;n++)a(c[n]);return a}({1:[function(n,r,t){"use strict";var e=t.parse=n("./lib/parse").parse,u=n("./lib/runtime-async").runtime,i=n("./lib/runtime-sync").runtime;function o(n,r){if("function"!=typeof n){var t=e(n,r);n=Function("G","I","S","U","V","return "+t)}return n}t.compileAsync=function(n,r){return u(o(n,r))},t.compile=function(n,r){return i(o(n,r))}},{"./lib/parse":2,"./lib/runtime-async":3,"./lib/runtime-sync":4}],2:[function(n,r,t){"use strict";t.parse=function u(i,o){var r=[];var t;var f="";var c={"&":b,"/":function(n){if(!r.length)throw new Error("Closing tag without opener: "+n);if(t!==n)throw new Error("Nesting error: "+t+" vs. "+n);r.pop(),t=r[r.length-1],m("","])",a)},"!":function(){},"^":function(n){t=n,r.push(t),m(f,'I("'+t+'",[')},">":function(n){m(f,'U(">'+A(n)+'")',a)},"#":function(n){t=n,r.push(t),m(f,'S("'+t+'",[')},"{":function(n){return b(n.substr(0,n.length-1))}};var a=",";var n="{{([^{}]*|{[^{}]*})}}";var s=["G(["];i+="";var p=o&&o.tag;p||i.replace(/{{=(.*?)=}}/,function(n,r,t){var e=i.substr(0,t);i=i.substr(t+n.length),-1<e.search(/(^|\n)[ \t]*$/)&&-1<i.search(/^[ \t]*(\r?\n|$)/)&&(e=e.replace(/[ \t]*$/,""),i=i.replace(/^[ \t]*\r?\n?/,"")),e&&s.push(u(e,o),a),p=A(r)});p&&(p=p.replace(/[!-.?\[-\]{-}]/g,w),n=p.replace(/\s+/,"(.*?)"));var e={"/":1,"!":1,"^":1,">":1,"#":1};var l=i.split(new RegExp(n));var v=l.length;for(var h=v-2;0<h;h-=2){var y=l[h-1],g=l[h+1],d=e[l[h][0]]&&(1===h?-1<y.search(/(^|\n)[ \t]*$/):-1<y.search(/\n[ \t]*$/))&&(h===v-2?-1<g.search(/^[ \t]*(\r?\n|$)/):-1<g.search(/^[ \t]*\r?\n/));d&&(l[h-1]=y.replace(/[ \t]*$/,""),l[h+1]=g.replace(/^[ \t]*\r?\n?/,""))}l.forEach(function(n,r){var t,e,u,i;1&r?(u=c[(e=n)[0]])?u(A(e.substr(1))):(i=A(e),m(f,'V("'+i+'")',a)):m(f,(t=n)&&"'"+t.replace(/([\x00-\x1F'\\])/g,w)+"'",a)});if(r.length)throw new Error("missing closing tag: "+t);m("])");return s.join("");function m(n,r,t){s.push(n,r),f=t}function b(n){m(f,'U("'+A(n)+'")',a)}};var e={"\t":"\\t","\n":"\\n","\r":"\\r","'":"\\'","\\":"\\\\"};function w(n){var r=n.charCodeAt(0);return e[n]||(r<16?"\\x0":"\\x")+r.toString(16).toUpperCase()}function A(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")}},{}],3:[function(n,r,t){"use strict";t.runtime=function(){var r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(t,u,e,o,i)};function t(r){return Array.isArray(r)||(r=[r]),function(t,n){return f(r,function(n,r){return"function"==typeof n?n(t,r):n},n)}}function e(n,r){var e=o(n),u=t(r);return function(r,t){return e(r,t).then(function(n){return Array.isArray(n)?f(n,u,t):n?u("object"==typeof n?n:r,t):void 0})}}function u(n,r){var e=o(n),u=t(r);return function(r,t){return e(r,t).then(function(n){if(!n||Array.isArray(n)&&!n.length)return u(r,t)})}}function i(n){var t=o(n);return function(n,r){return t(n,r).then(c)}}function o(n){if("."===n)return a;var r=n[0],i="."===r,o=">"===r;(o||i)&&(n=n.substr(1));var f=n.split("."),c=f.length;return function(n,r){var t,e,u;if(!o)for(u=n,t=0;u&&t<c;)u=(e=u)[f[t++]];if(!i&&!u)for(u=r,t=0;u&&t<c;)u=(e=u)[f[t++]];return"function"==typeof u?a().then(function(){return u.call(e,n,r)}):a(u)}}function f(n,t,e){var u=[];return n.reduce(function(n,r){return n.then(function(){return t(r,e)}).then(function(n){u.push(n)})},a()).then(function(){return u.join("")})}function a(n){return Promise.resolve(n)}function c(n){return"string"!=typeof n?n:n.replace(/[<"&>]/g,function(n){return r[n]})}}()},{}],4:[function(n,r,t){"use strict";t.runtime=function(){var u={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(t,e,r,o,i)};function t(e){return function(r,t){return Array.isArray(e)?f(e.map(n)):n(e);function n(n){return"function"!=typeof n?n:n(r,t)}}}function r(n,r){var e=o(n),u=t(r);return function(n,r){var t=e(n,r);if(Array.isArray(t))return f(t.map(function(n){return u(n,r)}));if(t)return u("object"==typeof t?t:n,r)}}function e(n,r){var e=o(n),u=t(r);return function(n,r){var t=e(n,r);if(!t||Array.isArray(t)&&!t.length)return u(n,r)}}function i(n){var e=o(n);return function(n,r){return"string"!=typeof(t=e(n,r))?t:t.replace(/[<"&>]/g,function(n){return u[n]});var t}}function o(n){if("."===n)return a;var r=n[0],i="."===r,o=">"===r;(o||i)&&(n=n.substr(1));var f=n.split("."),c=f.length;return function(n,r){var t,e,u;if(!o)for(u=n,t=0;u&&t<c;)u=(e=u)[f[t++]];if(!i&&!u)for(u=r,t=0;u&&t<c;)u=(e=u)[f[t++]];return"function"==typeof u?u.call(e,n,r):u||void 0}}function a(n){return n}function f(n){return n.join("")}}()},{}]},{},[1])(1)});
!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Promistache=n()}}(function(){return function i(o,f,c){function a(r,n){if(!f[r]){if(!o[r]){var t="function"==typeof require&&require;if(!n&&t)return t(r,!0);if(s)return s(r,!0);var e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}var u=f[r]={exports:{}};o[r][0].call(u.exports,function(n){return a(o[r][1][n]||n)},u,u.exports,i,o,f,c)}return f[r].exports}for(var s="function"==typeof require&&require,n=0;n<c.length;n++)a(c[n]);return a}({1:[function(n,r,t){"use strict";var e=t.parse=n("./lib/parse").parse,u=n("./lib/runtime-async").runtime,i=n("./lib/runtime-sync").runtime;function o(n,r){if("function"!=typeof n){var t=e(n,r);n=Function("G","I","S","U","V","return "+t)}return n}t.compileAsync=function(n,r){return u(o(n,r))},t.compile=function(n,r){return i(o(n,r))}},{"./lib/parse":2,"./lib/runtime-async":3,"./lib/runtime-sync":4}],2:[function(n,r,t){"use strict";t.parse=function u(i,o){var r=[];var t;var f="";var c={"&":b,"/":function(n){if(!r.length)throw new Error("Closing tag without opener: "+n);if(t!==n)throw new Error("Nesting error: "+t+" vs. "+n);r.pop(),t=r[r.length-1],m("","])",a)},"!":function(){},"^":function(n){t=n,r.push(t),m(f,'I("'+t+'",[')},">":function(n){m(f,'U(">'+x(n)+'")',a)},"#":function(n){t=n,r.push(t),m(f,'S("'+t+'",[')},"{":function(n){return b(n.substr(0,n.length-1))}};var a=",";var n="{{([^{}]*|{[^{}]*})}}";var s=["G(["];i+="";var l=o&&o.tag;l||i.replace(/{{=(.*?)=}}/,function(n,r,t){var e=i.substr(0,t);i=i.substr(t+n.length),-1<e.search(/(^|\n)[ \t]*$/)&&-1<i.search(/^[ \t]*(\r?\n|$)/)&&(e=e.replace(/[ \t]*$/,""),i=i.replace(/^[ \t]*\r?\n?/,"")),e&&s.push(u(e,o),a),l=x(r)});l&&(l=l.replace(/[!-.?\[-\]{-}]/g,w),n=l.replace(/\s+/,"(.*?)"));var e={"/":1,"!":1,"^":1,">":1,"#":1};var p=i.split(new RegExp(n));var h=p.length;for(var v=h-2;0<v;v-=2){var g=p[v-1],y=p[v+1],d=e[p[v][0]]&&(1===v?-1<g.search(/(^|\n)[ \t]*$/):-1<g.search(/\n[ \t]*$/))&&(v===h-2?-1<y.search(/^[ \t]*(\r?\n|$)/):-1<y.search(/^[ \t]*\r?\n/));d&&(p[v-1]=g.replace(/[ \t]*$/,""),p[v+1]=y.replace(/^[ \t]*\r?\n?/,""))}p.forEach(function(n,r){var t,e,u,i;1&r?(u=c[(e=n)[0]])?u(x(e.substr(1))):(i=x(e),m(f,'V("'+i+'")',a)):m(f,(t=n)&&"'"+t.replace(/([\x00-\x1F'\\])/g,w)+"'",a)});if(r.length)throw new Error("missing closing tag: "+t);m("])");return s.join("");function m(n,r,t){s.push(n,r),f=t}function b(n){m(f,'U("'+x(n)+'")',a)}};var e={"\t":"\\t","\n":"\\n","\r":"\\r","'":"\\'","\\":"\\\\"};function w(n){var r=n.charCodeAt(0);return e[n]||(r<16?"\\x0":"\\x")+r.toString(16).toUpperCase()}function x(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")}},{}],3:[function(n,r,t){"use strict";t.runtime=function(){var o=Array.isArray,r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(t,u,e,f,i)};function t(u){return function n(r,t,e){if(!e)return c(n,r,t);return a(u,r,t,e)}}function e(n,i){var r=f(n);return function n(t,e,u){if(!u)return c(n,t,e);return r(t,e).then(function(n){if(o(n))return s(n,r);if(n)return r("object"==typeof n?n:t);function r(n){return a(i,n,e,u)}})}}function u(n,u){var i=f(n);return function n(r,t,e){if(!e)return c(n,r,t);return i(r,t).then(function(n){if(!n||o(n)&&!n.length)return a(u,r,t,e)})}}function i(n){var t=f(n);return function(n,r){return t(n,r).then(p)}}function f(n){if("."===n)return l;var r=n[0],i="."===r,o=">"===r;i||o?n=n.substr(1):i=o=!0;var f=n.split("."),c=f.length;return function(n,r){var t,e,u;if(i)for(u=n,t=0;u&&t<c;)u=(e=u)[f[t++]];if(o&&!u)for(u=r,t=0;u&&t<c;)u=(e=u)[f[t++]];return"function"==typeof u?l().then(function(){return u.call(e,n,r)}):l(u)}}function c(n,r,t){var e;return l().then(function(){return n(r,t,u)}).then(function(){return e?e.join(""):""});function u(n){null!=n&&(e||(e=[]),e.push(n))}}function a(n,r,t,e){return s(n,function(n){if("function"==typeof n)return l().then(function(){return n(r,t)}).then(function(n){return s(n,e)});return e(n)})}function s(n,r){var t=l();return o(n)?n.forEach(e):e(n),t;function e(n){t=t.then(function(){return r(n)})}}function l(n){return Promise.resolve(n)}function p(n){if(null!=n)return"string"!=typeof n&&(n+=""),n.search(/["&>]/)<0?n:n.replace(/[<"&>]/g,function(n){return r[n]})}}()},{}],4:[function(n,r,t){"use strict";t.runtime=function(){var c=Array.isArray,e={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(r,u,t,a,i)};function r(u){return function n(r,t,e){if(!e)return s(n,r,t);l(u,r,t,e)}}function t(n,o){var f=a(n);return function n(r,t,e){if(!e)return s(n,r,t);var u=f(r,t);c(u)?u.forEach(i):u&&i("object"==typeof u?u:r);function i(n){l(o,n,t,e)}}}function u(n,i){var o=a(n);return function n(r,t,e){if(!e)return s(n,r,t);var u=o(r,t);(!u||c(u)&&!u.length)&&l(i,r,t,e)}}function i(n){var t=a(n);return function(n,r){return function(n){if(null==n)return;"string"!=typeof n&&(n+="");return n.search(/["&>]/)<0?n:n.replace(/[<"&>]/g,function(n){return e[n]})}(t(n,r))}}function a(n){if("."===n)return p;var r=n[0],i="."===r,o=">"===r;i||o?n=n.substr(1):i=o=!0;var f=n.split("."),c=f.length;return function(n,r){var t,e,u;if(i)for(u=n,t=0;u&&t<c;)u=(e=u)[f[t++]];if(o&&!u)for(u=r,t=0;u&&t<c;)u=(e=u)[f[t++]];return"function"==typeof u?u.call(e,n,r):u||void 0}}function s(n,r,t){var e;return n(r,t,function(n){null!=n&&(e||(e=[]),e.push(n))}),e?e.join(""):""}function l(n,t,e,u){o(n,function n(r){"function"==typeof r?o(r=r(t,e),n):u(r)})}function o(n,r){c(n)?n.forEach(r):r(n)}function p(n){return n}}()},{}]},{},[1])(1)});
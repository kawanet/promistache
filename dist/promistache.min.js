!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Promistache=n()}}(function(){return function i(o,f,c){function a(r,n){if(!f[r]){if(!o[r]){var t="function"==typeof require&&require;if(!n&&t)return t(r,!0);if(s)return s(r,!0);var e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}var u=f[r]={exports:{}};o[r][0].call(u.exports,function(n){return a(o[r][1][n]||n)},u,u.exports,i,o,f,c)}return f[r].exports}for(var s="function"==typeof require&&require,n=0;n<c.length;n++)a(c[n]);return a}({1:[function(n,r,t){"use strict";var e=t.parse=n("./lib/parse").parse,u=n("./lib/runtime-async").runtime,i=n("./lib/runtime-sync").runtime;function o(n,r){if("function"!=typeof n){var t=e(n,r);n=Function("G","I","S","U","V","return "+t)}return n}t.compileAsync=function(n,r){return u(o(n,r))},t.compile=function(n,r){return i(o(n,r))}},{"./lib/parse":2,"./lib/runtime-async":3,"./lib/runtime-sync":4}],2:[function(n,r,t){"use strict";t.parse=function u(i,o){var r=[];var t;var e="";var f={"&":E,"/":A,"!":C,"^":q,">":$,"#":j,"{":x};var c=",";var n="{{([^{}]*|{[^{}]*})}}";var a=["G(["];i+="";var s=o&&o.tag;s||i.replace(/{{=(.*?)=}}/,function(n,r,t){var e=i.substr(0,t);i=i.substr(t+n.length),-1<e.search(/(^|\n)[ \t]*$/)&&-1<i.search(/^[ \t]*(\r?\n|$)/)&&(e=e.replace(/[ \t]*$/,""),i=i.replace(/^[ \t]*\r?\n?/,"")),e&&a.push(u(e,o),c),s=N(r)});s&&(s=s.replace(/[!-.?\[-\]{-}]/g,F),n=s.replace(/\s+/,"(.*?)"));var l={"/":1,"!":1,"^":1,">":1,"#":1};var p=i.split(new RegExp(n));var h=p.length;for(var v=h-2;0<v;v-=2){var g=p[v-1],y=p[v+1],d=l[p[v][0]]&&(1===v?-1<g.search(/(^|\n)[ \t]*$/):-1<g.search(/\n[ \t]*$/))&&(v===h-2?-1<y.search(/^[ \t]*(\r?\n|$)/):-1<y.search(/^[ \t]*\r?\n/));d&&(p[v-1]=g.replace(/[ \t]*$/,""),p[v+1]=y.replace(/^[ \t]*\r?\n?/,""))}p.forEach(function(n,r){1&r?w(n):b(n)});if(r.length)throw new Error("missing closing tag: "+t);m("])");return a.join("");function m(n,r,t){a.push(n,r),e=t}function b(n){var r;m(e,(r=n)&&"'"+r.replace(/([\x00-\x1F'\\])/g,F)+"'",c)}function w(n){var r=f[n[0]];r?r(N(n.substr(1))):U(N(n))}function x(n){return E(n.substr(0,n.length-1))}function E(n){m(e,'U("'+N(n)+'")',c)}function $(n){m(e,'U(">'+N(n)+'")',c)}function j(n){t=n,r.push(t),m(e,'S("'+t+'",[')}function q(n){t=n,r.push(t),m(e,'I("'+t+'",[')}function A(n){if(!r.length)throw new Error("Closing tag without opener: "+n);if(t!==n)throw new Error("Nesting error: "+t+" vs. "+n);r.pop(),t=r[r.length-1],m("","])",c)}function U(n){m(e,'V("'+n+'")',c)}function C(){}};var e={"\t":"\\t","\n":"\\n","\r":"\\r","'":"\\'","\\":"\\\\"};function F(n){var r=n.charCodeAt(0);return e[n]||(r<16?"\\x0":"\\x")+r.toString(16).toUpperCase()}function N(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")}},{}],3:[function(n,r,t){"use strict";function e(u){return function n(r,t,e){if(!e)return c(n,r,t);return a(u,r,t,e)}}function u(n,i){var r=f(n);return function n(t,e,u){if(!u)return c(n,t,e);return r(t,e).then(function(n){if(h(n))return s(n,r);if(n)return r("object"==typeof n?n:t);function r(n){return a(i,n,e,u)}})}}function i(n,u){var i=f(n);return function n(r,t,e){if(!e)return c(n,r,t);return i(r,t).then(function(n){if(!n||h(n)&&!n.length)return a(u,r,t,e)})}}function o(n){var t=f(n);return function(n,r){return t(n,r).then(p)}}function f(n){if("."===n)return l;var r=n[0],i="."===r,o=">"===r;i||o?n=n.substr(1):i=o=!0;var f=n.split("."),c=f.length;return function(n,r){var t,e,u;if(i)for(u=n,t=0;u&&t<c;)u=(e=u)[f[t++]];if(o&&!u)for(u=r,t=0;u&&t<c;)u=(e=u)[f[t++]];return"function"==typeof u?l().then(function(){return u.call(e,n,r)}):l(u)}}function c(n,r,t){var e;return l().then(function(){return n(r,t,u)}).then(function(){return e?e.join(""):""});function u(n){null!=n&&(e=e||[]).push(n)}}function a(n,r,t,e){return s(n,function(n){return"function"!=typeof n?e(n):l().then(function(){return n(r,t)}).then(function(n){return s(n,e)})})}function s(n,r){var t=l();return h(n)?n.forEach(e):e(n),t;function e(n){t=t.then(function(){return r(n)})}}function l(n){return Promise.resolve(n)}function p(n){if(null!=n)return"string"!=typeof n&&(n+=""),n.search(/["&>]/)<0?n:n.replace(/[<"&>]/g,function(n){return v[n]})}var h,v;t.runtime=(h=Array.isArray,v={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"},function(n){return n(e,i,u,f,o)})},{}],4:[function(n,r,t){"use strict";function e(u){return function n(r,t,e){if(!e)return a(n,r,t);s(u,r,t,e)}}function u(n,o){var f=c(n);return function n(r,t,e){if(!e)return a(n,r,t);var u=f(r,t);p(u)?u.forEach(i):u&&i("object"==typeof u?u:r);function i(n){s(o,n,t,e)}}}function i(n,i){var o=c(n);return function n(r,t,e){if(!e)return a(n,r,t);var u=o(r,t);u&&(!p(u)||u.length)||s(i,r,t,e)}}function o(n){var t=c(n);return function(n,r){return function(n){if(null==n)return;"string"!=typeof n&&(n+="");return n.search(/["&>]/)<0?n:n.replace(/[<"&>]/g,function(n){return h[n]})}(t(n,r))}}function c(n){if("."===n)return l;var r=n[0],i="."===r,o=">"===r;i||o?n=n.substr(1):i=o=!0;var f=n.split("."),c=f.length;return function(n,r){var t,e,u;if(i)for(u=n,t=0;u&&t<c;)u=(e=u)[f[t++]];if(o&&!u)for(u=r,t=0;u&&t<c;)u=(e=u)[f[t++]];return"function"==typeof u?u.call(e,n,r):u||void 0}}function a(n,r,t){var e;return n(r,t,function(n){null!=n&&(e=e||[]).push(n)}),e?e.join(""):""}function s(n,t,e,u){f(n,function n(r){"function"==typeof r?f(r=r(t,e),n):u(r)})}function f(n,r){p(n)?n.forEach(r):r(n)}function l(n){return n}var p,h;t.runtime=(p=Array.isArray,h={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"},function(n){return n(e,i,u,c,o)})},{}]},{},[1])(1)});
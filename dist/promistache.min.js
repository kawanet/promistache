!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Promistache=n()}}(function(){return function i(o,f,c){function a(r,n){if(!f[r]){if(!o[r]){var t="function"==typeof require&&require;if(!n&&t)return t(r,!0);if(s)return s(r,!0);var e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}var u=f[r]={exports:{}};o[r][0].call(u.exports,function(n){return a(o[r][1][n]||n)},u,u.exports,i,o,f,c)}return f[r].exports}for(var s="function"==typeof require&&require,n=0;n<c.length;n++)a(c[n]);return a}({1:[function(n,r,t){"use strict";var e=t;function u(n,r){return Function("G","I","P","S","U","V","return "+e.parse(n,r))}e.compile=function(n,r){return e.runtime(u(n,r))},e.compileSync=function(n,r){return e.runtimeSync(u(n,r))},e.parse=n("./lib/parse").parse,e.runtime=n("./lib/runtime").runtime,e.runtimeSync=n("./lib/runtime-sync").runtimeSync},{"./lib/parse":2,"./lib/runtime":4,"./lib/runtime-sync":3}],2:[function(n,r,t){"use strict";t.parse=function i(o,f){var r=[];var t;var c="";var a={"&":h,"/":function(n){if(!r.length)throw new Error("Closing tag without opener: "+n);if(t!==n)throw new Error("Nesting error: "+t+" vs. "+n);r.pop(),t=r[r.length-1],g("","])",c)},"!":function(){},"^":function(n){t=n,r.push(t),g(c,'I("'+t+'",[')},">":function(n){g(c,'P("'+d(n)+'")',s)},"#":function(n){t=n,r.push(t),g(c,'S("'+t+'",[')},"{":function(n){return h(n.substr(0,n.length-1))}};var s=",";var n="{{([^{}]*|{[^{}]*})}}";var p=["G(["];o+="";var l=f&&f.tag;l||o.replace(/{{=(.*?)=}}|\n[ \t]*{{=(.*?)=}}[ \t]*\r?\n/,function(n,r,t,e){var u=o.substr(0,t?e+1:e);u&&p.push(i(u,f),s),l=d(r||t),o=o.substr(e+n.length)});l&&(n=l.replace(/[!-.?\[-\]{-}]/g,m).replace(/\s+/,"(.*?)"));var e=f&&f.spaces;if(!e){var u=new RegExp("^[ \t]*"+n+"[ \t]*\r?\n","mg"),v={"/":1,"!":1,"^":1,">":1,"#":1};o=o.replace(u,function(n,r){return v[r[0]]?d(n):n})}var y=new RegExp(n);o.split(y).forEach(function(n,r){if(1&r){var t=a[n[0]];t?t(d(n.substr(1))):(u=d(n),g(c,'V("'+u+'")',s))}else g(c,(e=n)&&"'"+e.replace(/([\x00-\x1F'\\])/g,m)+"'",s);var e,u});if(r.length)throw new Error("missing closing tag: "+t);g("])");return p.join("");function g(n,r,t){p.push(n,r),c=t}function h(n){g(c,'U("'+d(n)+'")',s)}};var e={"\t":"\\t","\n":"\\n","\r":"\\r","'":"\\'","\\":"\\\\"};function m(n){var r=n.charCodeAt(0);return e[n]||(r<16?"\\x0":"\\x")+r.toString(16).toUpperCase()}function d(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")}},{}],3:[function(n,r,t){"use strict";t.runtimeSync=function(){var u={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(t,e,f,r,o,i)};function t(e){return function(r,t){return Array.isArray(e)?s(e.map(n)):n(e);function n(n){return"function"!=typeof n?n:n(r,t)}}}function r(n,r){var e=c(n),u=t(r);return function(n,r){var t=e(n,r);if(Array.isArray(t))return s(t.map(function(n){return u(n,r)}));if(t)return u("object"==typeof t?t:n,r)}}function e(n,r){var e=c(n),u=t(r);return function(n,r){var t=e(n,r);if(!t||Array.isArray(t)&&!t.length)return u(n,r)}}function i(n){var e=c(n);return function(n,r){return"string"!=typeof(t=e(n,r))?t:t.replace(/[<"&>]/g,function(n){return u[n]});var t}}function o(n){return c(n)}function f(n){return c(n,1)}function c(n,i){if("."===n)return a;var o=n.split("."),f=o.length;return function(n,r){var t,e,u=!i&&n;for(e=0;u&&e<f;e++)u=(t=u)[o[e]];if(!u)for(u=r,e=0;u&&e<f;e++)u=(t=u)[o[e]];return"function"==typeof u?u.call(t,n,r):u||void 0}}function a(n){return n}function s(n){return n.join("")}}()},{}],4:[function(n,r,t){"use strict";t.runtime=function(){var r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"};return function(n){return n(t,u,f,e,o,i)};function t(r){return Array.isArray(r)||(r=[r]),function(t,n){return c(r,function(n,r){return"function"==typeof n?n(t,r):n},n)}}function e(n,r){var e=a(n),u=t(r);return function(r,t){return e(r,t).then(function(n){return Array.isArray(n)?c(n,u,t):n?u("object"==typeof n?n:r,t):void 0})}}function u(n,r){var e=a(n),u=t(r);return function(r,t){return e(r,t).then(function(n){if(!n||Array.isArray(n)&&!n.length)return u(r,t)})}}function i(n){var t=a(n);return function(n,r){return t(n,r).then(p)}}function o(n){return a(n)}function f(n){return a(n,1)}function c(n,t,e){var u=[];return n.reduce(function(n,r){return n.then(function(){return t(r,e)}).then(function(n){u.push(n)})},s()).then(function(){return u.join("")})}function a(n,i){if("."===n)return s;var o=n.split("."),f=o.length;return function(n,r){var t,e,u=!i&&n;for(e=0;u&&e<f;e++)u=(t=u)[o[e]];if(!u)for(u=r,e=0;u&&e<f;e++)u=(t=u)[o[e]];return"function"==typeof u?s().then(function(){return u.call(t,n,r)}):s(u)}}function s(n){return Promise.resolve(n)}function p(n){return"string"!=typeof n?n:n.replace(/[<"&>]/g,function(n){return r[n]})}}()},{}]},{},[1])(1)});